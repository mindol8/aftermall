<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>AUTOINMall</title>
    <link rel="icon" type="image/x-icon" href="../stylesheet/img/item/autoin_icon.png" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet"
        type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../stylesheet/css/styles.css" rel="stylesheet" />

    <!--sweetalert2-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/8.11.8/sweetalert2.all.min.js"
        rel="stylesheet">
    <!--swiper-->
    <link rel="stylesheet" href="https://unpkg.com/swiper@5.4.5/css/swiper.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper@5.4.5/css/swiper.min.css">
    <script src="https://unpkg.com/swiper@5.4.5/js/swiper.js"></script>
    <script src="https://unpkg.com/swiper@5.4.5/js/swiper.min.js"></script>

    <style>
      
          body {            
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 14px;
            color: #000;
            margin: 0;
            padding: 0;
          }      
          .swiper-container {
            background:silver;
            width: 100%;
            height: 300px;
            margin-left: auto;
            margin-right: auto;
          }
      
          .swiper-slide {
             
            background-size: cover;
            background-position: center;
          }
      
          .gallery-top {
            border-top:black solid 1px;
            border-left:black solid 1px;
            border-right:black solid 1px;
            margin-top:7%;
            height: 60%;
            width: 100%;
          }
      
          .gallery-thumbs {
            border-bottom:black solid 1px;
            border-left:black solid 1px;
            border-right:black solid 1px;
            height: 20%;
            box-sizing: border-box;
            padding: 10px 0;
          }
      
          .gallery-thumbs .swiper-slide {
            height: 100%;
            opacity: 0.4;
          }
      
          .gallery-thumbs .swiper-slide-thumb-active {
            opacity: 1;
          }
        </style>

</head>

<body>
    <div class="container">
        <div class="row" id="item_info_row">            
            <div class="col-sm-6">
                <!-- Swiper -->
                <div class="swiper-container gallery-top">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" id="top-img-0" >
                            <img src="../stylesheet/img/item/no_img.png" width="380" height="150">
                        </div>
                        <div class="swiper-slide" id="top-img-1" >
                            <img src="../stylesheet/img/item/no_img.png" width="380" height="150">
                        </div>
                        <div class="swiper-slide" id="top-img-2" >
                            <img src="../stylesheet/img/item/no_img.png" width="380" height="150">
                        </div>
                        <div class="swiper-slide" id="top-img-3" >
                            <img src="../stylesheet/img/item/no_img.png" width="380" height="150">
                        </div>
                        <div class="swiper-slide" id="top-img-4" >
                            <img src="../stylesheet/img/item/no_img.png" width="380" height="150">
                        </div>
                    </div>
                    <!-- Add Arrows -->
                    <div class="swiper-button-next swiper-button-black"></div>
                    <div class="swiper-button-prev swiper-button-black"></div>
                </div>
                <div class="swiper-container gallery-thumbs">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" id="thumb-img-0">
                            <img src="../stylesheet/img/item/no_img.png" style="width:80%;height:70%">
                      </div>
                        <div class="swiper-slide" id="thumb-img-1" >
                            <img src="../stylesheet/img/item/no_img.png" style="width:80%;height:70%">
                        </div>
                        <div class="swiper-slide" id="thumb-img-2" >
                            <img src="../stylesheet/img/item/no_img.png" style="width:80%;height:70%">
                        </div>
                        <div class="swiper-slide" id="thumb-img-3" >
                            <img src="../stylesheet/img/item/no_img.png" style="width:80%;height:70%">
                        </div>
                        <div class="swiper-slide" id="thumb-img-4" >
                            <img src="../stylesheet/img/item/no_img.png" style="width:80%;height:70%">
                        </div>
                    </div>
                </div>
                <input type="file" accept="image/*" id="item_img" name="item_img" multiple
                    style="margin-top:2%;border:black solid 1px;width:100%">

            </div>

            <div class="col-sm-6" id="item_head">
                <form>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Item name</span></div>
                        <input type="text" name="item_name" id="item_name" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Price</span></div>
                        <input type="text" name="item_price" id="item_price" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Parts Num</span></div>
                        <input type="text" name="parts_num" id="parts_num" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">volume</span></div>
                        <input type="text" name="item_volume" id="item_volume" class="form-control">
                    </div>
                    <div class="input-group mb-1">

                        <span class="input-group-text">Model</span>
                        <input type="text" name="item_model" id="item_model" class="form-control">

                        <span class="input-group-text">Version</span>
                        <input type="text" name="item_version" id="item_version" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Car Brand</span></div>
                        <input type="text" name="car_brand" id="car_brand" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Item Brand</span></div>
                        <input type="text" name="item_brand" id="item_brand" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Item manuf</span></div>
                        <input type="text" name="item_manuf" id="item_manuf" class="form-control">
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Category Main</span></div>
                        <select name="category_main" class="custom-select" id="category_main">
                            <option selected></option>
                        </select>
                    </div>
                    <div class="input-group mb-1">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Category Sub</span></div>
                        <select name="category_sub" class="custom-select" id="category_sub" disabled>
                            <option selected></option>
                        </select>
                    </div>
                </form>
            </div>

        </div>


        <!-- /.card -->
        <div class="card card-outline-secondary my-1">
            <div class="input-group-text">Item Desc</div>
            <textarea class="form-control" name="item_desc" id="item_desc"
                style="resize: none;height:200px;width:100%"></textarea>
        </div>
       
        <input type="button" class="btn btn-success btn-block" value="add" id="add_item">


        <!-- /.card -->

    </div>
    <!-- /.col-lg-9 -->




    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Contact form JS-->
    <script src="../stylesheet/mail/jqBootstrapValidation.js"></script>
    <script src="../stylesheet/mail/contact_me.js"></script>
    <script>
        $(document).ready(() => {
            var category = JSON.parse('<%- category %>');
            for (var i = 0; i < category.length; i++) {
                $("#category_main").append(
                    '<option value = "' + category[i].MAIN + '">' + category[i].MAIN + '</option>'
                );
            }

            $("#category_main").change(() => {
                var main = $("#category_main option:selected").val();
                if (main != "") {
                    $("#category_sub").html('<option selected></option>');

                    $.ajax({
                        url: "/item/add/category",
                        type: "post",
                        data: { main: main },
                        success: (data) => {
                            var sub = JSON.parse(data);
                            for (var j = 0; j < sub.length; j++) {
                                $("#category_sub").append(
                                    '<option value = "' + sub[j].SUB + '">' + sub[j].SUB + '</option>'
                                );
                            }
                            $("#category_sub").attr("disabled", false);
                        }
                    })
                }


            })

            //insert img and check it     
            $("#item_img").on("change", () => {                
                var file = $('#item_img')[0].files;
                var img_file;                                 
              //  console.log(file.length);
                if(file.length>5){
                    alert("size over");
                    $('#item_img').val("");
                    return;
                }else{
                    for(var i=0;i<file.length;i++){
                    img_file = file[i];
                    var src = URL.createObjectURL(img_file);
                   
                    $("#top-img-"+i+" img").attr('src',src);
                    
                    $("#thumb-img-"+i+" img").attr('src',src); 
            
                }
               
                }
              
               
            })
            $("#add_item").off("click").on("click", () => {
                const formdata = new FormData($("form")[0]);
                formdata.append("item_img", $('#item_img')[0].files[0]);
                formdata.append("item_img", $('#item_img')[0].files[1]);
                formdata.append("item_img", $('#item_img')[0].files[2]);
                formdata.append("item_img", $('#item_img')[0].files[3]);
                formdata.append("item_img", $('#item_img')[0].files[4]);
            
                var desc = $("#item_desc").val();
                formdata.append("item_desc", desc);
                $.ajax({
                    url: "/admin/item/add",
                    type: "post",
                    data: formdata,
                    contentType: false,
                    processData: false,
                    success: (data) => {
                        Swal.fire({
                            icon: 'success',
                            title: 'Add item',
                            text: 'PIN: ' + data,

                        }).then(() => {
                            location.reload();
                        }) 
                    },
                    error: () => {
                        alert("error");
                    }
                })
            })

            var galleryThumbs = new Swiper('.gallery-thumbs', {
                spaceBetween: 10,
                slidesPerView: 5,
                loop: true,
                freeMode: true,
                loopedSlides: 5, //looped slides should be the same
                watchSlidesVisibility: true,
                watchSlidesProgress: true,
            });
            var galleryTop = new Swiper('.gallery-top', {
                spaceBetween: 10,
                loop: true,
                loopedSlides: 5, //looped slides should be the same
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                thumbs: {
                    swiper: galleryThumbs,
                },
            });

        })
    </script>


</body>

</html>